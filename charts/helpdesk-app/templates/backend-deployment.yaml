apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ .Release.Name }}-backend
spec:
  replicas: 1  # <--- Ð’ÐÐ–ÐÐž: Ð”Ð»Ñ Block Volume (RWO) Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ° Ð´Ð¾Ð»Ð¶Ð½Ð° Ð±Ñ‹Ñ‚ÑŒ ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð¾Ð´Ð½Ð°
  selector:
    matchLabels:
      app: helpdesk-backend
  template:
    metadata:
      labels:
        app: helpdesk-backend
    spec:
      containers:
        - name: backend
          image: "{{ .Values.backend.repository }}:{{ .Values.backend.tag }}"
          ports:
            - containerPort: {{ .Values.backend.containerPort }}
          env:
            - name: DATABASE_URL
              value: "postgresql://postgres:mypassword@{{ .Release.Name }}-db-svc:5432/helpdesk"
          
          # ðŸ‘‡ 1. Ð¡ÑŽÐ´Ð° Ð¼Ð¾Ð½Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð´Ð¸ÑÐº (Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð°)
          volumeMounts:
            - name: data-storage
              mountPath: /app/uploads   # âš ï¸ Ð’ÐÐ–ÐÐž: Ð£Ð±ÐµÐ´Ð¸ÑÑŒ, Ñ‡Ñ‚Ð¾ Ñ‚Ð²Ð¾Ð¹ Python ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¸Ð¼ÐµÐ½Ð½Ð¾ ÑÑŽÐ´Ð°!
              
      # ðŸ‘‡ 2. Ð—Ð´ÐµÑÑŒ Ð±ÐµÑ€ÐµÐ¼ Ð´Ð¸ÑÐº Ð¸Ð· Kubernetes
      volumes:
        - name: data-storage
          persistentVolumeClaim:
            claimName: {{ .Release.Name }}-shared-pvc